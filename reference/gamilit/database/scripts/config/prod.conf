#!/bin/bash
##############################################################################
# GAMILIT Platform - Production Environment Configuration
# Archivo: prod.conf
# Uso: Cargado automáticamente por scripts cuando --env prod
##############################################################################

# ============================================================================
# DATABASE CONNECTION
# ============================================================================

# Host y puerto (servidor remoto)
export ENV_DB_HOST="74.208.126.102"
export ENV_DB_PORT="5432"

# SSL Configuration (OBLIGATORIO en prod)
export ENV_DB_SSL="true"
export ENV_DB_SSL_MODE="require"

# Connection Type
export ENV_CONNECTION_TYPE="remote"
export ENV_VALIDATE_REMOTE="true"

# ============================================================================
# SEEDS CONFIGURATION
# ============================================================================

# Seeds directory
export ENV_SEEDS_DIR="seeds/prod"

# Load demo data (DESHABILITADO en prod)
export ENV_LOAD_DEMO_DATA="false"
export ENV_LOAD_DEMO_USERS="false"
export ENV_LOAD_DEMO_EXERCISES="false"
export ENV_LOAD_DEMO_GAMIFICATION="false"

# ============================================================================
# VALIDATION
# ============================================================================

# Strict validation (MUY ESTRICTO en prod)
export ENV_STRICT_VALIDATION="true"

# Skip validations (NINGUNA en prod)
export ENV_SKIP_RLS_VALIDATION="false"
export ENV_SKIP_TRIGGER_VALIDATION="false"
export ENV_SKIP_INDEX_VALIDATION="false"

# Minimum object counts (esperados en prod)
export ENV_MIN_SCHEMAS="9"
export ENV_MIN_TABLES="64"
export ENV_MIN_FUNCTIONS="60"
export ENV_MIN_TRIGGERS="50"
export ENV_MIN_RLS_POLICIES="200"
export ENV_MIN_INDEXES="250"

# ============================================================================
# SECURITY
# ============================================================================

# Password requirements (MUY ESTRICTO en prod)
export ENV_REQUIRE_STRONG_PASSWORD="true"
export ENV_MIN_PASSWORD_LENGTH="32"
export ENV_GENERATE_PASSWORD="true"

# Additional security
export ENV_REQUIRE_PASSWORD_CONFIRMATION="true"
export ENV_SAVE_CREDENTIALS_ENCRYPTED="true"

# ============================================================================
# PERFORMANCE
# ============================================================================

# Parallel execution
export ENV_PARALLEL_INDEXES="true"
export ENV_PARALLEL_SEEDS="false"

# Timeouts (más largos en prod por conexión remota)
export ENV_DDL_TIMEOUT="600"       # 10 minutos
export ENV_SEED_TIMEOUT="1200"     # 20 minutos

# ============================================================================
# LOGGING
# ============================================================================

# Log level: warning | error (menos verboso en prod)
export ENV_LOG_LEVEL="warning"

# Log file
export ENV_LOG_FILE="logs/init-prod-$(date +%Y%m%d-%H%M%S).log"

# Verbose output (deshabilitado en prod)
export ENV_VERBOSE="false"

# ============================================================================
# FEATURES
# ============================================================================

# Feature flags para producción
export ENV_ENABLE_EXPERIMENTAL="false"
export ENV_ENABLE_DEBUG_QUERIES="false"
export ENV_ENABLE_QUERY_LOGGING="false"

# ============================================================================
# BACKUP
# ============================================================================

# Crear backup antes de operaciones destructivas
export ENV_CREATE_BACKUP_BEFORE_DROP="true"
export ENV_BACKUP_DIR="backups/pre-init"

# ============================================================================
# NOTIFICATIONS
# ============================================================================

# Notificaciones (placeholder para futuro)
export ENV_NOTIFY_ON_SUCCESS="false"
export ENV_NOTIFY_ON_ERROR="true"
export ENV_NOTIFICATION_EMAIL=""

# ============================================================================
# NOTES
# ============================================================================

# Ambiente: Producción
# - SIN datos demo
# - Validaciones ESTRICTAS
# - SSL OBLIGATORIO
# - Conexión remota (74.208.126.102)
# - Logs mínimos (warning/error)
# - Backups automáticos
#
# ⚠️  IMPORTANTE:
# - Requiere acceso SSH o VPN al servidor
# - Requiere certificados SSL válidos
# - NO ejecutar sin autorización
